!function(e){"function"==typeof require&&"object"==typeof exports&&"object"==typeof module?e(require("knockout"),exports):"function"==typeof define&&define.amd?define(["knockout","exports"],e):e(ko,ko.mapping={})}(function(e,n){function t(e,n){e.extend(p(n)?{fn:n}:n)}var r={},o=Array.prototype.forEach,i=Object.prototype.toString,u=Array.isArray||function(e){return"[object Array]"===i.call(e)},f=function(e){return"[object String]"===i.call(e)},c=function(e){return e===Object(e)},a=function(e){return e===!0||e===!1||"[object Boolean]"===i.call(e)},l=function(e){return i.call(e)==="[object "+Number+"]"||!isNaN(e)},p=function(e){return i.call(e)==="[object "+Function+"]"},s=function(e){return i.call(e)==="[object "+Date+"]"};"function"!=typeof/./&&(p=function(e){return"function"==typeof e});var b=function(e,n,t){if(null!==e)if(o&&e.forEach===o)e.forEach(n,t);else if(u(e)){for(var i=0,f=e.length;f>i;i+=1)if(n.call(t,e[i],i,e)===r)return}else for(var c in e)if(n.call(t,e[c],c,e)===r)return};n.toJSONByPrototype=e.toJSONByPrototype=function(e,n){var t=e,r=function(e,n,t){return Object.keys(n).forEach(function(o){if(t[o]){var i=n[o];if(u(i))if(e[o]=[],u(t[o]))e[o]=t[o];else{var s=t[o](),d=i.length>0&&i[0]&&c(i[0]);d?b(s,function(n){e[o].push(r({},i[0],n))}):b(s,function(n){e[o].push(p(n)?n():n)})}else if(f(i)||l(i)||a(i))e[o]=p(t[o])?t[o]():t[o];else{if(p(i))return;if(c(i)&&p(i.read)&&p(i.write))return;c(i)&&(e[o]={},r(e[o],i,i._observable?t[o]():t[o]))}}}),e};return r({},n,t)},n.resetViewModel=e.resetViewModel=function(e){var n=e,t=function(e){return e?(p(e)?e.originalValue&&e(e.originalValue()):c(e)&&b(e,function(n,r){t(e[r])}),e):void 0};t(n)},n.updateViewModel=e.updateViewModel=function(e,t){var r=e,o=function(e,t,r){return e&&t&&b(e,function(e,i){if(t[i]){var s=r+"."+i;if(u(e)&&t[i]){t[i]([]);var d=e.length>0&&e[0]&&c(e[0]);d?b(e,function(e){t[i].push(n.mapObject({},e))}):t[i](e)}else if(f(e)||l(e)||a(e))t[i]&&p(t[i])&&t[i](e);else{if(p(e))return;if(c(e)&&p(e.read)&&p(e.write))return;c(e)&&o(e,t[i],s)}}}),t};o(t,r,"")},e.extenders.originalValue=function(n,t){n.originalValue||(n.originalValue=e.observable(t))},n.mapObject=e.mapObject=function(n,r,o,i,d){var v=n,y=r,h=o||{},g=i||{},j=d||{},V=function(n,r,o,i){var d=o||{};return b(n,function(n,o){if("_observable"!==o)if(u(n)){r[o]=e.observableArray(),d[o]&&t(r[o],u(d[o])&&d[o].length>0?d[o][0]:d[o]);var v=n.length>0&&n[0]&&c(n[0]);v?b(n,function(e){r[o].push(V(e,{},{},i))}):b(n,function(e){r[o].push(e)})}else if(f(n)||l(n)||a(n)||s(n))r[o]=e.observable(n).extend({originalValue:n}),d[o]&&t(r[o],d[o]);else{if(p(n))return;if(c(n)&&p(n.read)&&p(n.write))return;c(n)&&(r[o]=n._observable?e.observable():{},V(n,r[o],d[o],i))}}),r},m=function(n,t,r){return b(n,function(n,o){if(u(n)){var i=n.length>0&&n[0]&&c(n[0]);i&&b(n,function(e){V(e,{},r)})}else{if(f(n)||l(n)||a(n)||s(n))return;p(n)?t[o]=e.pureComputed(n,r):c(n)&&p(n.read)&&p(n.write)?t[o]=e.pureComputed(n,r):c(n)&&m(n,t[o],r)}}),t},w=function(e,n,t){b(e,function(e,r){u(e)?(n[r]=[],b(e,function(e){n[r].push(p(e)?e.bind(t):e)})):p(e)?n[r]=e.bind(t):c(e)&&(n[r]||(n[r]={}),w(e,n[r],t))})};return b(j,function(e,n){v[n]=e}),V(y,v,h,v),m(y,v,v),w(g,v,v),v.init&&v.init(),v}});